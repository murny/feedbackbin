#!/usr/bin/env sh

if ! gem list foreman -i --silent; then
  echo "Installing foreman..."
  gem install foreman
fi

# Default to port 3000 if not specified
export PORT="${PORT:-3000}"

# Let the debug gem allow remote connections,
# but avoid loading until `debugger` is called
export RUBY_DEBUG_OPEN="true"
export RUBY_DEBUG_LAZY="true"

echo ""
echo "______            _ _                _   ______ _       "
echo "|  ___|          | | |              | |  | ___ (_)      "
echo "| |_ ___  ___  __| | |__   __ _  ___| | _| |_/ /_ _ __  "
echo "|  _/ _ \/ _ \/ _\` | '_ \ / _\` |/ __| |/ / ___ \ | '_ \ "
echo "| ||  __/  __/ (_| | |_) | (_| | (__|   <| |_/ / | | | |"
echo "\_| \___|\___|\__,_|_.__/ \__,_|\___|_|\_\____/|_|_| |_|"
echo ""
echo "Login with shane@example.com at: http://localhost:$PORT/"
echo ""

exec foreman start -f Procfile.dev "$@"
