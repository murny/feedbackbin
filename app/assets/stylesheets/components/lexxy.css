/* ==========================================================================
   Lexxy Rich Text Editor Component

   Imports Lexxy's built-in CSS (zero-specificity :where() selectors) into
   the base layer, then applies thin overrides in the components layer.
   ========================================================================== */

@import url("lexxy-variables.css") layer(base);
@import url("lexxy-content.css") layer(base);
@import url("lexxy-editor.css") layer(base);

:root {
  --lexxy-color-ink: var(--color-foreground);
  --lexxy-color-ink-medium: var(--color-muted-foreground);
  --lexxy-color-ink-lighter: var(--color-border);
  --lexxy-color-ink-lightest: var(--color-muted);
  --lexxy-color-ink-inverted: var(--color-ink-inverted);
  --lexxy-color-canvas: var(--color-canvas);
  --lexxy-color-text: var(--color-foreground);
  --lexxy-color-text-subtle: var(--color-muted-foreground);
  --lexxy-color-link: var(--color-link);
  --lexxy-color-accent-dark: var(--color-link);
  --lexxy-color-selected: var(--color-accent);
  --lexxy-shadow: var(--shadow-md);
  --lexxy-font-base: var(--font-sans);
  --lexxy-font-mono: var(--font-mono);
  --lexxy-focus-ring-color: var(--color-ring);
  --lexxy-z-popup: var(--z-modal);
  --lexxy-content-margin: 0.5lh;
  --lexxy-color-code-token-att: var(--color-code-token-attr);
  --lexxy-color-code-token-property: var(--color-code-token-property);
  --lexxy-color-code-token-selector: var(--color-code-token-selector);
  --lexxy-color-code-token-comment: var(--color-code-token-comment);
  --lexxy-color-code-token-operator: var(--color-code-token-operator);
  --lexxy-color-code-token-function: var(--color-code-token-function);
  --lexxy-color-code-token-variable: var(--color-code-token-variable);
  --lexxy-color-code-token-punctuation: var(--color-code-token-punctuation);
}

@layer components {
  /* Editor â€” transparent because we wrap editors in our own containers */
  lexxy-editor {
    background-color: transparent;
    border: none;
    border-radius: 0;
  }

  .lexxy-editor__content {
    min-block-size: calc(7lh + 1rem);
    padding: 0.75rem;

    ::selection {
      background: color-mix(in oklch, var(--color-primary) 50%, transparent);
    }
  }

  /* Toolbar */
  lexxy-toolbar {
    background-color: var(--color-card);
    border-start-start-radius: var(--radius-md);
    border-start-end-radius: var(--radius-md);
  }

  .lexxy-editor__toolbar-button {
    &:is(:focus, :hover) {
      background-color: var(--color-accent);
    }

    &:is(:active),
    &[aria-pressed="true"] {
      background-color: color-mix(in oklch, var(--color-primary) 20%, transparent);
    }
  }

  /* Content */
  .lexxy-content {
    h1, h2, h3, h4, h5, h6 {
      font-weight: 800;
      letter-spacing: -0.02ch;
      line-height: 1.1;
    }

    ol, ul {
      margin-inline-start: 0;
      padding-inline-start: 3ch;
    }

    p:has(+ p) {
      margin: 0;
    }

    p, blockquote {
      letter-spacing: -0.005ch;
    }

    code, pre {
      border: 1px solid var(--color-border);
      font-size: 0.85em;
      font-weight: 500;
    }

    hr {
      color: currentColor;
      block-size: 0;
      border: none;
      border-block-end: 2px solid currentColor;
      inline-size: 20%;
      margin: calc(var(--lexxy-content-margin) * 2) 0;
    }
  }

  /* Mention avatar images */
  action-text-attachment[content-type^="application/vnd.actiontext.mention"] {
    img {
      object-fit: cover;
    }
  }
}
