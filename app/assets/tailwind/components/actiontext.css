/*
 * Tailwind-based ActionText/Lexxy editor styles
 * Replaces the default Trix styles with Lexxy styles that match the design system
 */

/* Lexxy Editor */
lexxy-editor {
  @apply block relative overflow-visible;
}

lexxy-editor .lexxy-editor__content {
  @apply border border-input bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus:ring-[3px] focus:ring-ring/50 focus:border-ring disabled:cursor-not-allowed disabled:opacity-50 dark:bg-input/30 md:text-sm;
  @apply rounded-md min-h-48;
}

/* Placeholder for empty editor */
.lexxy-editor--empty .lexxy-editor__content:not(:has(ul, ol))::before {
  content: attr(placeholder);
  @apply text-muted-foreground cursor-text opacity-60 pointer-events-none absolute whitespace-pre-line;
}

/* Lexxy Toolbar */
lexxy-toolbar {
  @apply bg-card border-b border-border flex text-inherit m-0 max-w-full p-1 relative sticky top-0 z-10;
}

.lexxy-editor__toolbar-button {
  @apply appearance-none aspect-square bg-transparent h-8 border-none rounded-sm text-inherit cursor-pointer grid text-inherit place-items-center;
}

.lexxy-editor__toolbar-button:hover,
.lexxy-editor__toolbar-button:focus {
  @apply bg-accent text-accent-foreground shadow-none;
}

.lexxy-editor__toolbar-button:active,
.lexxy-editor__toolbar-button[aria-pressed="true"] {
  @apply bg-accent text-accent-foreground;
}

.lexxy-editor__toolbar-button svg {
  @apply h-4 w-4 fill-current;
}

.lexxy-editor__toolbar-spacer {
  @apply flex-1;
}

/* Toolbar overflow menu */
.lexxy-editor__toolbar-overflow-menu {
  @apply bg-card rounded-md shadow-lg flex flex-wrap absolute right-0 p-1 z-10;
}

/* Toolbar dropdowns */
.lexxy-editor__toolbar-dropdown-content {
  @apply bg-card border border-border rounded-lg shadow-lg text-foreground text-sm p-3 absolute z-10;
}

.lexxy-editor__toolbar-dropdown-content button {
  @apply h-8;
}

.lexxy-editor__toolbar-dropdown-actions {
  @apply flex text-xs flex-1 gap-3 mt-3;
}

.lexxy-editor__toolbar-dropdown-actions .btn {
  @apply w-full;
}

/* Link dialog */
.lexxy-editor__toolbar-link-form {
  @apply flex flex-col gap-2;
}

.lexxy-editor__toolbar-link-form + .lexxy-editor__toolbar-dropdown-row {
  @apply mt-3;
}

.lexxy-editor__toolbar-dropdown-row {
  @apply flex items-center gap-2 flex-wrap;
}

/* Code language picker */
.lexxy-code-language-picker {
  @apply appearance-none bg-card border border-border rounded-full text-foreground cursor-pointer text-xs font-medium leading-tight m-1 mr-1 px-2 py-1 text-left;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='m12 19.5c-.7 0-1.3-.3-1.7-.8l-9.8-11.1c-.7-.8-.6-1.9.2-2.6.8-.6 1.9-.6 2.5.2l8.6 9.8c0 .1.2.1.4 0l8.6-9.8c.7-.8 1.8-.9 2.6-.2s.9 1.8.2 2.6l-9.8 11.1c-.4.5-1.1.8-1.7.8z' fill='currentColor'/%3E%3C/svg%3E");
  background-position: center right 0.5em;
  background-repeat: no-repeat;
  background-size: 0.5em;
  padding-right: 1.5em;
}

/* Prompt menu (@mentions, etc.) */
.lexxy-prompt-menu {
  @apply bg-card rounded-lg shadow-lg text-foreground text-sm list-none m-0 max-h-52 min-w-[20ch] overflow-auto p-1 invisible z-50;
}

.lexxy-prompt-menu--visible {
  @apply visible;
}

.lexxy-prompt-menu__item {
  @apply items-center rounded-sm cursor-pointer flex gap-1 p-1 whitespace-nowrap;
}

.lexxy-prompt-menu__item:hover {
  @apply bg-accent text-accent-foreground;
}

.lexxy-prompt-menu__item[aria-selected] {
  @apply bg-accent text-accent-foreground;
}

.lexxy-prompt-menu__item img {
  @apply h-6 w-6 rounded-full flex-shrink-0 m-0;
}

.lexxy-prompt-menu__item + .lexxy-prompt-menu__item {
  @apply mt-0.5;
}

.lexxy-prompt-menu__item--empty {
  @apply text-muted-foreground p-1;
}

/* Drag and drop */
.lexxy-editor--drag-over {
  @apply bg-accent rounded outline-2 outline-dashed outline-ring;
}

/* Attachment selection */
lexxy-editor figure.node--selected,
lexxy-editor div.node--selected {
  @apply ring-2 ring-ring ring-offset-2;
}

lexxy-editor figure.node--selected:has(img) img,
lexxy-editor div.node--selected:has(img) img {
  @apply ring-2 ring-ring ring-offset-2;
}

/* Lexxy Content Styles (for rendered ActionText) */
.lexxy-content {
  @apply leading-6 break-words;
  word-break: break-word;
}

.lexxy-content * {
  @apply box-border m-0 p-0;
}

.lexxy-content h1 {
  @apply text-xl leading-tight mb-2 mt-4 first:mt-0;
}

.lexxy-content h2 {
  @apply text-lg leading-tight mb-2 mt-4 first:mt-0;
}

.lexxy-content h3 {
  @apply text-base font-semibold leading-tight mb-2 mt-4 first:mt-0;
}

.lexxy-content p {
  @apply mb-2;
}

.lexxy-content p:last-child {
  @apply mb-0;
}

.lexxy-content blockquote {
  @apply border-0 border-l-4 border-solid border-border ml-1 pl-3 italic;
}

.lexxy-content [dir=rtl] blockquote,
.lexxy-content blockquote[dir=rtl] {
  @apply border-0 border-r-4 border-solid border-border mr-1 pr-3;
}

.lexxy-content ul,
.lexxy-content ol {
  @apply ml-6 mb-2;
}

.lexxy-content ul {
  @apply list-disc;
}

.lexxy-content ol {
  @apply list-decimal;
}

.lexxy-content li {
  @apply mb-1;
}

.lexxy-content [dir=rtl] li {
  @apply mr-4;
}

.lexxy-content pre {
  @apply block w-full align-top font-mono text-sm p-3 whitespace-pre bg-muted rounded-md overflow-x-auto mb-2;
}

.lexxy-content code {
  @apply font-mono text-sm bg-muted px-1 py-0.5 rounded;
}

.lexxy-content pre code {
  @apply bg-transparent p-0;
}

.lexxy-content img {
  @apply max-w-full h-auto rounded;
}

.lexxy-content a {
  @apply text-primary underline;
}

.lexxy-content a:hover {
  @apply no-underline;
}

.lexxy-content b,
.lexxy-content strong,
.lexxy-content .lexxy-content__bold {
  @apply font-bold;
}

.lexxy-content i,
.lexxy-content em,
.lexxy-content .lexxy-content__italic {
  @apply italic;
}

.lexxy-content s,
.lexxy-content .lexxy-content__strikethrough {
  @apply line-through;
}

.lexxy-content mark,
.lexxy-content .lexxy-content__highlight {
  @apply bg-yellow-200 dark:bg-yellow-800;
}

/* Attachment styles */
.lexxy-content .attachment {
  @apply inline-block relative max-w-full;
}

.lexxy-content .attachment a {
  @apply text-inherit no-underline;
}

.lexxy-content .attachment a:hover,
.lexxy-content .attachment a:visited:hover {
  @apply text-inherit;
}

.lexxy-content .attachment__caption {
  @apply text-center;
}

.lexxy-content .attachment__caption .attachment__name + .attachment__size::before {
  content: ' â€¢ ';
}

.lexxy-content .attachment--preview {
  @apply w-full text-center;
}

.lexxy-content .attachment--preview .attachment__caption {
  @apply text-muted-foreground text-sm leading-tight;
}

.lexxy-content .attachment--file {
  @apply text-foreground leading-none my-0 mx-1 mb-1 py-2 px-4 border border-border rounded-md;
}

.lexxy-content .attachment-gallery {
  @apply flex flex-wrap relative;
}

.lexxy-content .attachment-gallery .attachment {
  @apply flex-[1_0_33%] px-2 max-w-[33%];
}

.lexxy-content .attachment-gallery.attachment-gallery--2 .attachment,
.lexxy-content .attachment-gallery.attachment-gallery--4 .attachment {
  @apply flex-[1_0_50%] max-w-[50%];
}

/* ActionText attachment wrapper fixes */
.lexxy-content .attachment-gallery > action-text-attachment,
.lexxy-content .attachment-gallery > .attachment {
  @apply flex-[1_0_33%] px-2 max-w-[33%];
}

.lexxy-content .attachment-gallery.attachment-gallery--2 > action-text-attachment,
.lexxy-content .attachment-gallery.attachment-gallery--2 > .attachment,
.lexxy-content .attachment-gallery.attachment-gallery--4 > action-text-attachment,
.lexxy-content .attachment-gallery.attachment-gallery--4 > .attachment {
  @apply flex-[1_0_50%] max-w-[50%];
}

.lexxy-content action-text-attachment .attachment {
  @apply p-0 max-w-full;
}
