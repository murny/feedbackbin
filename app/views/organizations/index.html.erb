<% content_for :title, t(".title") %>

<div class="container mx-auto px-4 py-8">
  <div class="flex flex-col space-y-8">
    <!-- Header Section -->
    <div class="flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0">
      <div class="space-y-1">
        <h1 class="text-3xl font-bold tracking-tight text-foreground">
          <%= t(".title") %>
        </h1>
        <p class="text-muted-foreground">
          <%= t(".description") %>
        </p>
      </div>
      <%= render_button(
        text: t(".new_organization"),
        href: new_organization_path,
        variant: :default
      ) %>
    </div>

    <!-- Search Section -->
    <div class="w-full max-w-md mb-8"
         data-controller="search"
         data-search-delay-value="300"
         data-search-loading-class="opacity-75"
         data-search-filtering-class="ring-2 ring-primary">
      <%= form_with url: organizations_path, method: :get,
          data: {
            turbo_frame: "organizations_list",
            turbo_action: "replace",
            search_target: "form"
          } do |form| %>
        <%= form.label :search, t(".search_label"), class: "sr-only" %>
        <%= form.text_field :search,
            placeholder: t(".search_placeholder"),
            value: params[:search],
            autocomplete: "off",
            class: "w-full px-4 py-2 border border-input bg-background rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring",
            data: {
              search_target: "input",
              action: "input->search#search"
            } %>
      <% end %>
    </div>

    <!-- Organizations List -->
    <%= turbo_frame_tag "organizations_list",
        data: { action: "turbo:frame-load->search#searchComplete" } do %>
      <%= render "organizations_list", organizations: @organizations %>
    <% end %>
  </div>
</div>
