<%# locals: (parent:, comment: Comment.new) %>

<div data-controller="reply-form">
  <button type="button"
          aria-expanded="false"
          aria-controls="<%= dom_id(parent, :reply_form) %>"
          data-reply-form-target="trigger"
          data-action="click->reply-form#expand"
          class="reply-trigger">
    <%= t("comments.thread_reply_form.placeholder") %>
  </button>

  <div id="<%= dom_id(parent, :reply_form) %>" data-reply-form-target="form" class="display-none">
    <%= form_with model: comment, url: idea_comments_path(parent.idea), class: "full-width" do |form| %>
      <%= render "error_messages", resource: form.object %>
      <%= form.hidden_field :parent_id, value: parent.id %>

      <div class="comment-editor">
        <%= form.rich_text_area :body,
              id: "#{dom_id(parent)}_new_reply_body",
              placeholder: t("comments.thread_reply_form.placeholder"),
              data: { reply_form_target: "input" } do %>
          <%= rich_text_prompts %>
        <% end %>
      </div>

      <div class="margin-block-start-half flex align-center gap-half justify-end">
        <%= button_tag t("cancel"), type: "button", class: "btn btn--secondary btn--sm", data: { action: "click->reply-form#collapse" } %>
        <%= form.submit t("comments.thread_reply_form.submit"), class: "btn btn--primary btn--sm" %>
      </div>
    <% end %>
  </div>
</div>
