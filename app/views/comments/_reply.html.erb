<%# locals: (comment:) %>

<%= turbo_frame_tag comment do %>
  <div class="p-4 lg:p-6 mb-4 text-base bg-card border border-border rounded-lg">
    <div class="flex">
      <div class="mr-4">
        <%= render partial: "votes/vote_button", locals: { voteable: comment } %>
      </div>
      <div class="flex-1 min-w-0">
        <div class="flex justify-between items-center mb-2">
          <div class="flex items-center">
            <%= avatar_tag comment.creator, class: "mr-2 w-6 h-6 rounded-full", alt: comment.creator.name %>

            <p class="inline-flex flex-col md:flex-row items-start mr-3 text-sm text-foreground">
              <span class="font-semibold"><%= comment.creator.name %></span>
              <%= local_datetime_tag comment.created_at, style: :datetime, class: "text-sm text-muted-foreground md:ml-2" %>
            </p>
          </div>
          <%= render Elements::DropdownMenuComponent.new do |dropdown| %>
            <% dropdown.with_trigger(variant: :ghost, size: :icon, class: "text-muted-foreground") do %>
              <%= lucide_icon("ellipsis") %>
              <span class="sr-only"><%= t(".comment_settings") %></span>
            <% end %>

            <% if Current.user&.can_administer_comment?(comment) %>
              <% dropdown.with_item_content(href: edit_idea_comment_path(comment.idea, comment)) do %>
                <%= t("edit") %>
              <% end %>
              <% dropdown.with_item_content(
                href: idea_comment_path(comment.idea, comment),
                method: :delete,
                form: { data: { turbo_confirm: t("are_you_sure") } }
              ) do %>
                <%= t("remove") %>
              <% end %>
            <% end %>

            <% dropdown.with_item_content(href: "#") do %>
              <%= t("report") %>
            <% end %>
          <% end %>
        </div>
        <div class="text-muted-foreground" data-controller="syntax-highlight">
          <%= comment.body %>
        </div>
      </div>
    </div>
  </div>
<% end %>
