<%# locals: (comment:) %>

<%= turbo_frame_tag dom_id(comment) do %>
  <div class="pl-6 pt-6 border-left">
    <div class="p-4 lg:p-6 mb-6 text-base bg-card border border-border rounded-lg">
      <div class="flex">
        <div class="mr-4">
          <%= render partial: "likes/like_button", locals: { likeable: comment } %>
        </div>
        <div class="w-full">
          <div class="flex justify-between items-center mb-2 w-full">
            <div class="flex items-center">
              <%= avatar_tag comment.creator, class: "mr-2 w-6 h-6 rounded-full", alt: comment.creator.name %>

              <a href="#" class="flex items-center">
                  <p class="inline-flex flex-col md:flex-row items-start mr-3 text-sm text-foreground">
                      <span class="font-semibold"><%= comment.creator.name %></span>
                      <%= local_datetime_tag comment.created_at, style: :datetime, class: "text-sm text-muted-foreground md:ml-2" %>
                  </p>
              </a>
            </div>
            <%= render Ui::DropdownMenuComponent.new do |dropdown| %>
              <% dropdown.with_trigger do %>
                <button type="button" class="inline-flex items-center justify-center p-2 text-sm font-medium text-muted-foreground rounded-md transition-colors hover:bg-accent hover:text-accent-foreground">
                  <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 3">
                    <path d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z" />
                  </svg>
                  <span class="sr-only">Comment settings</span>
                </button>
              <% end %>

              <% dropdown.with_item_content(href: edit_comment_path(comment)) do %>
                <%= t("edit") %>
              <% end %>

              <% dropdown.with_item_content(
                href: comment_path(comment),
                method: :delete,
                form: { data: { turbo_confirm: t("are_you_sure") } }
              ) do %>
                <%= t("remove") %>
              <% end %>

              <% dropdown.with_item_content(href: "#") do %>
                <%= t("report") %>
              <% end %>
            <% end %>
          </div>
          <p class="text-muted-foreground">
            <%= comment.body %>
          </p>
        </div>
      </div>
      <div id="<%= dom_id(comment) %>_replies" class="mt-5">
        <%= render partial: "comments/reply", collection: comment.replies.ordered, as: :comment %>
      </div>

      <%= render partial: "comments/reply_form", locals: { parent: comment, comment: Comment.new } %>
    </div>
  </div>
<% end %>
