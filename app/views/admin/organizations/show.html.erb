<% content_for :title, @organization.name %>

<div class="space-y-8">
  <!-- Header Section -->
  <div class="flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0">
    <div class="space-y-1">
      <h1 class="text-3xl font-bold tracking-tight text-foreground">
        <%= @organization.name %>
      </h1>
      <p class="text-muted-foreground">
        Organization details and activity
      </p>
    </div>
    <%= render_button(
      text: "Back to Organizations",
      href: admin_organizations_path,
      variant: :outline
    ) %>
  </div>

  <!-- Organization Info -->
  <%= render_card(title: "Organization Information", class: "px-6") do %>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="space-y-4">
        <div class="flex items-center space-x-4">
          <%= organization_logo(@organization, size: :lg) %>
          <div>
            <h3 class="text-lg font-semibold text-foreground"><%= @organization.name %></h3>
            <p class="text-sm text-muted-foreground">Created <%= time_ago_in_words(@organization.created_at) %> ago</p>
          </div>
        </div>
      </div>
      
      <div class="space-y-4">
        <div>
          <h4 class="text-sm font-medium text-foreground mb-2">Owner</h4>
          <div class="flex items-center space-x-3">
            <%= render_avatar(
              src: @organization.owner.avatar.attached? ? url_for(@organization.owner.avatar) : nil,
              alt: @organization.owner.name,
              size: :sm,
              fallback: @organization.owner.name[0, 2].upcase
            ) %>
            <div>
              <div class="font-medium text-foreground"><%= @organization.owner.name %></div>
              <div class="text-sm text-muted-foreground"><%= @organization.owner.email_address %></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Stats -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
    <%= render_card(class: "px-6") do %>
      <div class="text-center">
        <div class="text-2xl font-bold text-foreground"><%= @organization.users.count %></div>
        <div class="text-sm text-muted-foreground">Members</div>
      </div>
    <% end %>

    <%= render_card(class: "px-6") do %>
      <div class="text-center">
        <div class="text-2xl font-bold text-foreground"><%= @organization.posts.count %></div>
        <div class="text-sm text-muted-foreground">Posts</div>
      </div>
    <% end %>

    <%= render_card(class: "px-6") do %>
      <div class="text-center">
        <div class="text-2xl font-bold text-foreground"><%= @organization.categories.count %></div>
        <div class="text-sm text-muted-foreground">Categories</div>
      </div>
    <% end %>
  </div>

  <!-- Recent Activity -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Recent Posts -->
    <%= render_card(title: "Recent Posts", class: "px-6") do %>
      <% if @recent_posts.any? %>
        <div class="space-y-4">
          <% @recent_posts.each do |post| %>
            <div class="flex items-start space-x-3 p-3 rounded-lg hover:bg-muted/50 transition-colors">
              <%= render_avatar(
                src: post.author.avatar.attached? ? url_for(post.author.avatar) : nil,
                alt: post.author.name,
                size: :sm,
                fallback: post.author.name[0, 2].upcase
              ) %>
              <div class="min-w-0 flex-1">
                <div class="font-medium text-foreground truncate"><%= post.title %></div>
                <div class="text-sm text-muted-foreground">
                  by <%= post.author.name %> â€¢ <%= time_ago_in_words(post.created_at) %> ago
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8 text-muted-foreground">
          No posts yet
        </div>
      <% end %>
    <% end %>

    <!-- Recent Members -->
    <%= render_card(title: "Recent Members", class: "px-6") do %>
      <% if @recent_memberships.any? %>
        <div class="space-y-4">
          <% @recent_memberships.each do |membership| %>
            <div class="flex items-center justify-between p-3 rounded-lg hover:bg-muted/50 transition-colors">
              <div class="flex items-center space-x-3">
                <%= render_avatar(
                  src: membership.user.avatar.attached? ? url_for(membership.user.avatar) : nil,
                  alt: membership.user.name,
                  size: :sm,
                  fallback: membership.user.name[0, 2].upcase
                ) %>
                <div>
                  <div class="font-medium text-foreground"><%= membership.user.name %></div>
                  <div class="text-sm text-muted-foreground"><%= membership.user.email_address %></div>
                </div>
              </div>
              <%= render_badge(
                text: membership.role.humanize,
                variant: membership.administrator? ? :default : :secondary
              ) %>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8 text-muted-foreground">
          No members yet
        </div>
      <% end %>
    <% end %>
  </div>
</div>