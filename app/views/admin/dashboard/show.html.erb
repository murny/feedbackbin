<% content_for :title, t(".title", account_name: Current.account.name) %>

<header style="padding-block-end: var(--space-6);">
  <div>
    <h1 class="txt-xx-large font-weight-bold">
      <%= t(".heading", account_name: Current.account.name) %>
    </h1>
    <p class="txt-small txt-subtle margin-block-start-half">
      <%= t(".description") %>
    </p>
  </div>
</header>

<div style="margin-block-end: var(--space-8);">
  <h2 class="txt-medium font-weight-bold margin-block-end"><%= t(".stats.title") %></h2>
  <dl class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5">
    <div class="panel panel--stat">
      <div class="pad">
        <div class="flex align-center">
          <div class="flex-item-no-shrink">
            <%= lucide_icon "lightbulb", class: "size-8 txt-primary" %>
          </div>
          <div class="flex-1" style="margin-inline-start: var(--space-5); inline-size: 0;">
            <dl>
              <dt class="panel__stat-label"><%= t(".stats.total_ideas") %></dt>
              <dd class="panel__stat-value">
                <%= number_with_delimiter(@stats[:total_ideas] || 0) %>
              </dd>
            </dl>
          </div>
        </div>
      </div>
      <div class="panel__stat-footer">
        <span class="txt-subtle"><%= t(".stats.this_month") %>:</span>
        <span class="font-weight-medium">
          <%= number_with_delimiter(@stats[:ideas_this_month] || 0) %>
        </span>
      </div>
    </div>

    <div class="panel panel--stat">
      <div class="pad">
        <div class="flex align-center">
          <div class="flex-item-no-shrink">
            <%= lucide_icon "users", class: "size-8 txt-primary" %>
          </div>
          <div class="flex-1" style="margin-inline-start: var(--space-5); inline-size: 0;">
            <dl>
              <dt class="panel__stat-label"><%= t(".stats.total_users") %></dt>
              <dd class="panel__stat-value">
                <%= number_with_delimiter(@stats[:total_users] || 0) %>
              </dd>
            </dl>
          </div>
        </div>
      </div>
      <div class="panel__stat-footer">
        <span class="txt-subtle"><%= t(".stats.admins") %>:</span>
        <span class="font-weight-medium">
          <%= number_with_delimiter(@stats[:admin_users] || 0) %>
        </span>
      </div>
    </div>

    <div class="panel panel--stat">
      <div class="pad">
        <div class="flex align-center">
          <div class="flex-item-no-shrink">
            <%= lucide_icon "message-circle", class: "size-8 txt-primary" %>
          </div>
          <div class="flex-1" style="margin-inline-start: var(--space-5); inline-size: 0;">
            <dl>
              <dt class="panel__stat-label"><%= t(".stats.total_comments") %></dt>
              <dd class="panel__stat-value">
                <%= number_with_delimiter(@stats[:total_comments] || 0) %>
              </dd>
            </dl>
          </div>
        </div>
      </div>
      <div class="panel__stat-footer">
        <span class="txt-subtle"><%= t(".stats.this_month") %>:</span>
        <span class="font-weight-medium">
          <%= number_with_delimiter(@stats[:comments_this_month] || 0) %>
        </span>
      </div>
    </div>
  </dl>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
  <div class="panel">
    <div class="panel__body">
      <h3 class="txt-medium font-weight-medium margin-block-end">
        <%= t(".recent_ideas.title") %>
      </h3>

      <% if @recent_ideas.present? %>
        <ul class="list-style-none" style="margin-block-end: -2rem;">
          <% @recent_ideas.each_with_index do |idea, index| %>
            <li>
              <div class="position-relative" style="padding-block-end: var(--space-8);">
                <% unless index == @recent_ideas.length - 1 %>
                  <span style="position: absolute; inset-inline-start: 1rem; inset-block-start: 1rem; margin-inline-start: -1px; block-size: 100%; inline-size: 2px; background-color: var(--color-border);" aria-hidden="true"></span>
                <% end %>
                <div class="position-relative flex gap-3">
                  <div>
                    <span class="size-8 fill-primary flex align-center justify-center" style="border-radius: 9999px; box-shadow: 0 0 0 8px var(--color-background);">
                      <%= lucide_icon "lightbulb", class: "size-4 txt-reversed" %>
                    </span>
                  </div>
                  <div class="flex min-width flex-1 justify-space-between" style="gap: var(--space-4); padding-block-start: 0.375rem;">
                    <div>
                      <p class="txt-small font-weight-medium">
                        <%= link_to idea.title, idea_path(idea) %>
                      </p>
                      <p class="txt-small txt-subtle">
                        <%= t(".recent_ideas.by_creator", creator: idea.creator.name) %>
                        <% if idea.board %>
                          â€¢ <%= t(".recent_ideas.in_board", board: idea.board.name) %>
                        <% end %>
                      </p>
                    </div>
                    <div class="txt-nowrap txt-small txt-subtle" style="text-align: end;">
                      <time datetime="<%= idea.created_at.iso8601 %>">
                        <%= time_ago_in_words(idea.created_at) %> <%= t(".recent_ideas.ago") %>
                      </time>
                    </div>
                  </div>
                </div>
              </div>
            </li>
          <% end %>
        </ul>

        <div style="margin-block-start: var(--space-6);">
          <%= link_to ideas_path,
                class: "btn btn--outline full-width flex justify-center align-center" do %>
            <%= t(".recent_ideas.view_all") %>
            <%= lucide_icon "arrow-right", class: "size-4", style: "margin-inline-start: var(--space-2);" %>
          <% end %>
        </div>
      <% else %>
        <div class="txt-align-center pad-block-12">
          <%= lucide_icon "lightbulb", class: "size-12 txt-subtle center" %>
          <h3 class="txt-small font-weight-medium margin-block-start-half"><%= t(".recent_ideas.no_ideas_title") %></h3>
          <p class="txt-small txt-subtle" style="margin-block-start: var(--space-1);"><%= t(".recent_ideas.no_ideas_description") %></p>
        </div>
      <% end %>
    </div>
  </div>

  <div class="panel">
    <div class="panel__body">
      <h3 class="txt-medium font-weight-medium margin-block-end">
        <%= t(".recent_comments.title") %>
      </h3>

      <% if @recent_comments.present? %>
        <ul class="list-style-none" style="margin-block-end: -2rem;">
          <% @recent_comments.each_with_index do |comment, index| %>
            <li>
              <div class="position-relative" style="padding-block-end: var(--space-8);">
                <% unless index == @recent_comments.length - 1 %>
                  <span style="position: absolute; inset-inline-start: 1rem; inset-block-start: 1rem; margin-inline-start: -1px; block-size: 100%; inline-size: 2px; background-color: var(--color-border);" aria-hidden="true"></span>
                <% end %>
                <div class="position-relative flex gap-3">
                  <div>
                    <span class="size-8 flex align-center justify-center" style="border-radius: 9999px; background-color: var(--color-secondary); box-shadow: 0 0 0 8px var(--color-background);">
                      <%= lucide_icon "message-circle", class: "size-4", style: "color: var(--color-secondary-foreground);" %>
                    </span>
                  </div>
                  <div class="flex min-width flex-1 justify-space-between" style="gap: var(--space-4); padding-block-start: 0.375rem;">
                    <div>
                      <p class="txt-small">
                        <span class="font-weight-medium"><%= comment.creator.name %></span>
                        <%= t(".recent_comments.commented") %>
                      </p>
                      <p class="txt-small txt-subtle">
                        <%= link_to comment.idea.title, idea_path(comment.idea) %>
                      </p>
                    </div>
                    <div class="txt-nowrap txt-small txt-subtle" style="text-align: end;">
                      <time datetime="<%= comment.created_at.iso8601 %>">
                        <%= time_ago_in_words(comment.created_at) %> <%= t(".recent_comments.ago") %>
                      </time>
                    </div>
                  </div>
                </div>
              </div>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="txt-align-center pad-block-12">
          <%= lucide_icon "message-circle", class: "size-12 txt-subtle center" %>
          <h3 class="txt-small font-weight-medium margin-block-start-half"><%= t(".recent_comments.no_comments_title") %></h3>
          <p class="txt-small txt-subtle" style="margin-block-start: var(--space-1);"><%= t(".recent_comments.no_comments_description") %></p>
        </div>
      <% end %>
    </div>
  </div>
</div>
