<%# locals: (post_status:) %>

<%= render_form_with model: post_status, url: post_status.persisted? ? admin_settings_post_status_path(post_status) : admin_settings_post_statuses_path, method: post_status.persisted? ? :patch : :post, html: { data: { controller: "status-preview" } } do |f| %>
  <div class="grid gap-6">
    <div class="grid gap-3">
      <%= f.label :name, t(".name_label") %>
      <%= f.text_field :name, placeholder: t(".name_placeholder"), data: { status_preview_target: "nameInput", action: "input->status-preview#updatePreview" } %>
    </div>

    <div class="grid gap-3">
      <%= f.label :color, t(".color_label") %>
      <div class="flex items-center gap-3">
        <%= f.color_field :color, class: "h-10 w-20 rounded-md border border-input cursor-pointer", data: { status_preview_target: "colorInput", action: "input->status-preview#updatePreview" } %>
        <span class="text-sm text-muted-foreground"><%= t(".color_hint") %></span>
      </div>
    </div>

    <div class="grid gap-3">
      <%= f.label :position, t(".position_label") %>
      <%= f.number_field :position, min: 1, placeholder: t(".position_placeholder") %>
      <p class="text-xs text-muted-foreground"><%= t(".position_hint") %></p>
    </div>

    <% if post_status.persisted? %>
      <div class="grid gap-3">
        <div class="flex items-center space-x-2">
          <%= f.check_box :set_as_default,
                checked: post_status == Current.organization.default_post_status,
                class: "h-4 w-4 rounded border-input text-primary focus:ring-primary" %>
          <%= f.label :set_as_default, t(".set_as_default_label"), class: "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70" %>
        </div>
        <p class="text-xs text-muted-foreground"><%= t(".set_as_default_hint") %></p>
      </div>
    <% end %>

    <div class="rounded-lg border border-border bg-muted/50 p-4">
      <h4 class="text-sm font-medium mb-2"><%= t(".preview_label") %></h4>
      <span data-status-preview-target="badge" class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold text-white" style="background-color: <%= post_status.color.presence || "#3b82f6" %>;">
        <%= post_status.name.presence || t(".preview_placeholder") %>
      </span>
    </div>
  </div>

  <div class="mt-8 flex items-center justify-end gap-3">
    <%= link_to t("cancel"), admin_settings_post_statuses_path, class: "btn btn-secondary" %>
    <%= render_button text: post_status.persisted? ? t(".save_changes") : t(".create_status"), type: :submit, variant: :default %>
  </div>
<% end %>
