<% content_for :title, @user.name %>

<div class="space-y-8">
  <!-- Header Section -->
  <div class="flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0">
    <div class="space-y-1">
      <h1 class="text-3xl font-bold tracking-tight text-foreground">
        <%= @user.name %>
      </h1>
      <p class="text-muted-foreground">
        <%= t(".description") %>
      </p>
    </div>
    <div class="flex gap-2">
      <%= render Ui::ButtonComponent.new(
        href: admin_users_path,
        variant: :outline
      ) do %>
        <%= t(".back_button") %>
      <% end %>
      <%= render Ui::ButtonComponent.new(
        href: user_path(@user),
        variant: :outline
      ) do %>
        <%= t(".view_profile") %>
      <% end %>
    </div>
  </div>

  <!-- User Info -->
  <%= render_card(title: t(".user_info_title"), class: "px-6") do %>
    <div class="flex items-start space-x-6">
      <%= render Ui::AvatarComponent.new(
        src: @user.avatar.attached? ? url_for(@user.avatar) : nil,
        alt: @user.name,
        size: :xl,
        fallback: @user.name[0, 2].upcase
      ) %>

      <div class="flex-1 space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="text-sm font-medium text-foreground mb-2"><%= t(".basic_info_title") %></h4>
            <div class="space-y-2 text-sm">
              <div><strong><%= t(".name_label") %>:</strong> <%= @user.name %></div>
              <div><strong><%= t(".email_label") %>:</strong> <%= @user.email_address %></div>
              <% if @user.username.present? %>
                <div><strong><%= t(".username_label") %>:</strong> @<%= @user.username %></div>
              <% end %>
              <div>
                <strong><%= t(".joined_label") %>:</strong>
                <%= @user.created_at.strftime("%B %d, %Y") %>
                (<%= time_ago_in_words(@user.created_at) %> <%= t(".ago") %>)
              </div>
              <% if @last_session %>
                <div>
                  <strong><%= t(".last_sign_in") %>:</strong>
                  <%= time_ago_in_words(@last_session.last_active_at) %> <%= t(".ago") %>
                </div>
              <% else %>
                <div>
                  <strong><%= t(".last_sign_in") %>:</strong>
                  <span class="text-muted-foreground"><%= t(".never_signed_in") %></span>
                </div>
              <% end %>
            </div>
          </div>

          <div class="space-y-4">
            <!-- Role -->
            <div>
              <h4 class="text-sm font-medium text-foreground mb-3"><%= t(".role_label") %></h4>
              <%= render "role_section", user: @user %>
            </div>

            <!-- Account Status -->
            <div>
              <h4 class="text-sm font-medium text-foreground mb-3"><%= t(".account_status_label") %></h4>
              <%= render "status_section", user: @user %>
            </div>

            <!-- Email Verification -->
            <div>
              <h4 class="text-sm font-medium text-foreground mb-3"><%= t(".email_verification_label") %></h4>
              <%= render_badge(
                text: @user.email_verified? ? t(".verified_badge") : t(".unverified_badge"),
                variant: @user.email_verified? ? :default : :outline
              ) %>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Activity Statistics -->
  <%= render_card(title: t(".activity_stats_title"), class: "px-6") do %>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
      <div class="p-4 border border-border rounded-lg">
        <div class="text-2xl font-bold text-foreground"><%= @total_posts %></div>
        <div class="text-sm text-muted-foreground"><%= t(".total_posts") %></div>
      </div>
      <div class="p-4 border border-border rounded-lg">
        <div class="text-2xl font-bold text-foreground"><%= @total_comments %></div>
        <div class="text-sm text-muted-foreground"><%= t(".total_comments") %></div>
      </div>
      <div class="p-4 border border-border rounded-lg">
        <div class="text-2xl font-bold text-foreground"><%= @total_likes %></div>
        <div class="text-sm text-muted-foreground"><%= t(".total_likes") %></div>
      </div>
    </div>
  <% end %>

  <!-- Recent Posts -->
  <%= render_card(title: t(".recent_posts_title"), class: "px-6") do %>
    <% if @recent_posts.any? %>
      <div class="space-y-4">
        <% @recent_posts.each do |post| %>
          <div class="flex items-start space-x-3 p-3 rounded-lg hover:bg-muted/50 transition-colors">
            <div class="min-w-0 flex-1">
              <div class="font-medium text-foreground truncate"><%= post.title %></div>
              <div class="text-sm text-muted-foreground">
                <%= time_ago_in_words(post.created_at) %> <%= t(".ago") %>
              </div>
              <% if post.category %>
                <%= render_badge(
                  text: post.category.name,
                  variant: :outline
                ) %>
              <% end %>
            </div>
            <div class="text-xs text-muted-foreground">
              <%= pluralize(post.likes_count, t(".like_singular"), t(".like_plural")) %> â€¢ <%= pluralize(post.comments_count, t(".comment_singular"), t(".comment_plural")) %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-center py-8 text-muted-foreground">
        <%= t(".no_posts") %>
      </div>
    <% end %>
  <% end %>
</div>
