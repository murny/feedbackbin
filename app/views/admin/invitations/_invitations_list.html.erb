<%# locals: (invitations:, pagy:) %>

<% if invitations.any? %>
  <div class="card">
    <ul role="list" class="divide-y divide-gray-200 dark:divide-gray-700">
      <% invitations.each do |invitation| %>
        <li class="flex items-center justify-between gap-x-6 py-5 px-6">
          <div class="min-w-0 flex-1">
            <div class="flex items-start gap-x-3">
              <div class="min-w-0 flex-auto">
                <p class="text-sm font-semibold leading-6 text-foreground">
                  <%= invitation.email %>
                  <% if invitation.name.present? %>
                    <span class="text-muted-foreground font-normal">(<%= invitation.name %>)</span>
                  <% end %>
                </p>
                <div class="mt-1 flex flex-wrap items-center gap-x-2 gap-y-1 text-xs leading-5 text-muted-foreground">
                  <p>
                    <%= t(".invited_by") %> <%= invitation.invited_by.name %>
                  </p>
                  <svg viewBox="0 0 2 2" class="h-0.5 w-0.5 fill-current">
                    <circle cx="1" cy="1" r="1" />
                  </svg>
                  <p>
                    <%= time_ago_in_words(invitation.created_at) %> <%= t(".ago") %>
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div class="flex flex-none items-center gap-x-2">
            <%= button_to_copy_to_clipboard(invitation_url(invitation.token)) do %>
              <%= lucide_icon "copy", class: "h-4 w-4" %>
              <span class="sr-only"><%= t(".copy_invitation_link") %></span>
            <% end %>
            <%= render_button(
              variant: :outline,
              size: :icon,
              href: resend_admin_invitation_path(invitation),
              data: { turbo_method: :post, turbo_confirm: t(".resend_confirm"), tooltip: t(".resend") }
            ) do %>
              <%= lucide_icon "mail", class: "h-4 w-4" %>
              <span class="sr-only"><%= t(".resend") %></span>
            <% end %>
            <%= render_button(
              variant: :destructive,
              size: :icon,
              href: admin_invitation_path(invitation),
              data: { turbo_method: :delete, turbo_confirm: t(".cancel_confirm"), tooltip: t(".cancel_invitation") }
            ) do %>
              <%= lucide_icon "x", class: "h-4 w-4" %>
              <span class="sr-only"><%= t(".cancel_invitation") %></span>
            <% end %>
          </div>
        </li>
      <% end %>
    </ul>
  </div>
<% else %>
  <div class="card p-8 text-center">
    <%= lucide_icon "mail-check", class: "mx-auto h-12 w-12 text-muted-foreground" %>
    <h3 class="mt-4 text-lg font-semibold text-foreground"><%= t(".no_invitations_title") %></h3>
    <p class="mt-2 text-sm text-muted-foreground"><%= t(".no_invitations_description") %></p>
  </div>
<% end %>

<!-- Pagination -->
<% if pagy.pages > 1 %>
  <div class="mt-8 space-y-4">
    <div class="text-center text-sm text-muted-foreground">
      <%== pagy_info(pagy) %>
    </div>
    <div class="flex justify-center">
      <%== pagy_nav(pagy, link_extra: 'data-turbo-frame="invitations_content"') %>
    </div>
  </div>
<% end %>
