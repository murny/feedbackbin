<%# locals: (path_helper:, categories:, selected_category:, turbo_frame:, preserve_params: {}) %>

<div class="flex items-center gap-2">
  <label class="text-sm font-medium text-muted-foreground"><%= t(".category_label") %></label>
  <%= render Ui::DropdownMenuComponent.new do |dropdown| %>
    <% dropdown.with_trigger do %>
      <%= selected_category&.name || t(".all_categories") %>
    <% end %>

    <% dropdown.with_item_content(
      href: send(path_helper, **clean_params(**preserve_params, category_id: nil)),
      data: { turbo_frame: turbo_frame },
      class: selected_category ? nil : "bg-accent"
    ) do %>
      <%= t(".all_categories") %>
    <% end %>

    <% categories.each do |category| %>
      <% dropdown.with_item_content(
        href: send(path_helper, **clean_params(**preserve_params, category_id: category.id)),
        data: { turbo_frame: turbo_frame },
        class: selected_category == category ? "bg-accent" : nil
      ) do %>
        <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: <%= category.color %>;"></span>
        <span><%= category.name %></span>
      <% end %>
    <% end %>
  <% end %>
</div>
