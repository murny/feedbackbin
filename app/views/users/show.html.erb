<!-- Back to ideas link -->
<div class="center pad-inline" style="padding-block: var(--space-4);">
  <div class="container">
    <%= link_to root_path, class: "flex-inline align-center gap-half txt-small txt-subtle" do %>
      <%= lucide_icon "chevron-left", class: "size-4" %>
      <%= t(".back_to_ideas") %>
    <% end %>
  </div>
</div>

<!-- Main Profile Card -->
<div class="center pad-inline" style="padding-block-end: var(--space-6);">
  <div class="container">
    <%= render Elements::PanelComponent.new(style: "padding-block-start: 0;") do |c| %>
      <% c.with_body(class: "unpad") do %>
        <!-- User Banner (placeholder) -->
        <div class="user-profile__banner"></div>

        <div style="padding: 0 var(--space-6) var(--space-6);">
        <!-- Avatar and Basic Info Section -->
        <div class="user-profile__header">
          <div class="flex justify-center" style="flex-shrink: 0;">
            <%= render Elements::AvatarComponent.new(
              src: fresh_user_avatar_path(@user),
              size: :xl,
              fallback: @user.name,
              class: "user-profile__avatar-ring"
            ) %>
          </div>

          <div class="user-profile__info">
            <div class="user-profile__name-section">
              <h1 class="txt-x-large font-weight-bold"><%= @user.name %></h1>
            </div>

            <!-- Action Buttons -->
            <div class="user-profile__actions">
              <% if Current.user == @user %>
                <%= render Elements::ButtonComponent.new(
                  variant: :outline,
                  href: user_settings_profile_path
                ) do %>
                  <%= lucide_icon "square-pen", class: "size-4", style: "margin-inline-end: var(--space-2);" %>
                  <%= t(".edit_profile") %>
                <% end %>
              <% else %>
                <%= render Elements::ButtonComponent.new(
                  variant: :outline
                ) do %>
                  <%= lucide_icon "triangle-alert", class: "size-4", style: "margin-inline-end: var(--space-2);" %>
                  <%= t(".report_user") %>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>

        <!-- Bio Section -->
        <% if @user.bio.present? %>
          <div class="user-profile__bio">
            <p class="txt-subtle"><%= @user.bio %></p>
          </div>
        <% end %>

        <!-- Details Section -->
        <div class="margin-block-start-double">
          <h3 class="txt-medium font-weight-bold margin-block-end"><%= t(".details") %></h3>
          <dl class="user-profile__detail-grid">
            <%# TODO: Add location field to User model and profile edit form %>
            <div class="flex align-center gap-3">
              <div class="user-profile__detail-icon">
                <%= lucide_icon "map-pin", class: "size-4 txt-subtle" %>
              </div>
              <div>
                <dt class="txt-small font-weight-medium txt-subtle"><%= t(".location") %></dt>
                <dd class="txt-small txt-subtle"><%= t(".not_specified") %></dd>
              </div>
            </div>

            <div class="flex align-center gap-3">
              <div class="user-profile__detail-icon">
                <%= lucide_icon "shield", class: "size-4 txt-subtle" %>
              </div>
              <div>
                <dt class="txt-small font-weight-medium txt-subtle"><%= t(".role") %></dt>
                <dd class="txt-small"><%= @user.role.humanize %></dd>
              </div>
            </div>

            <%# TODO: Add website field to User model and profile edit form %>
            <div class="flex align-center gap-3">
              <div class="user-profile__detail-icon">
                <%= lucide_icon "globe", class: "size-4 txt-subtle" %>
              </div>
              <div>
                <dt class="txt-small font-weight-medium txt-subtle"><%= t(".website") %></dt>
                <dd class="txt-small txt-subtle"><%= t(".not_specified") %></dd>
              </div>
            </div>

            <%# TODO: Add twitter_handle field to User model and profile edit form %>
            <div class="flex align-center gap-3">
              <div class="user-profile__detail-icon">
                <%= lucide_icon "user", class: "size-4 txt-subtle" %>
              </div>
              <div>
                <dt class="txt-small font-weight-medium txt-subtle"><%= t(".twitter") %></dt>
                <dd class="txt-small txt-subtle"><%= t(".not_specified") %></dd>
              </div>
            </div>

            <%# TODO: Add linkedin_handle field to User model and profile edit form %>
            <div class="flex align-center gap-3">
              <div class="user-profile__detail-icon">
                <%= inline_svg_tag "icons/brand/linkedin.svg", class: "size-4 txt-subtle" %>
              </div>
              <div>
                <dt class="txt-small font-weight-medium txt-subtle"><%= t(".linkedin") %></dt>
                <dd class="txt-small txt-subtle"><%= t(".not_specified") %></dd>
              </div>
            </div>

            <%# TODO: Add github_handle field to User model and profile edit form %>
            <div class="flex align-center gap-3">
              <div class="user-profile__detail-icon">
                <%= inline_svg_tag "icons/brand/github.svg", class: "size-4 txt-subtle" %>
              </div>
              <div>
                <dt class="txt-small font-weight-medium txt-subtle"><%= t(".github") %></dt>
                <dd class="txt-small txt-subtle"><%= t(".not_specified") %></dd>
              </div>
            </div>

            <div class="flex align-center gap-3">
              <div class="user-profile__detail-icon">
                <%= lucide_icon "calendar", class: "size-4 txt-subtle" %>
              </div>
              <div>
                <dt class="txt-small font-weight-medium txt-subtle"><%= t(".joined") %></dt>
                <dd class="txt-small"><%= local_datetime_tag @user.created_at, style: :date %></dd>
              </div>
            </div>
          </dl>
        </div>

        <!-- Achievements Section -->
        <div class="margin-block-start-double">
          <h3 class="txt-medium font-weight-bold margin-block-end"><%= t(".achievements") %></h3>
          <div class="flex flex-wrap gap-2">
            <%= render Elements::BadgeComponent.new(variant: :default) do %>
              <%= lucide_icon "trophy" %>
              <%= t(".achievements_top_contributor") %>
            <% end %>
            <%= render Elements::BadgeComponent.new(variant: :secondary) do %>
              <%= lucide_icon "thumbs-up" %>
              <%= t(".achievements_helpful") %>
            <% end %>
            <%= render Elements::BadgeComponent.new(variant: :outline) do %>
              <%= lucide_icon "rocket" %>
              <%= t(".achievements_early_adopter") %>
            <% end %>
          </div>
        </div>

        <!-- Stats Section -->
        <div class="margin-block-start-double">
          <div class="user-profile__stats-grid">
            <div class="user-profile__stat">
              <div class="user-profile__stat-value"><%= @stats[:ideas_count] %></div>
              <div class="user-profile__stat-label"><%= t(".stats_ideas_created") %></div>
            </div>
            <div class="user-profile__stat">
              <div class="user-profile__stat-value"><%= @stats[:total_votes] %></div>
              <div class="user-profile__stat-label"><%= t(".stats_total_votes_received") %></div>
            </div>
            <div class="user-profile__stat">
              <div class="user-profile__stat-value"><%= @stats[:comments_count] %></div>
              <div class="user-profile__stat-label"><%= t(".stats_comments") %></div>
            </div>
            <div class="user-profile__stat">
              <div class="user-profile__stat-value"><%= @stats[:helpful_votes] %></div>
              <div class="user-profile__stat-label"><%= t(".stats_helpful_votes_received") %></div>
            </div>
          </div>
        </div>
        </div>
      <% end %>
    <% end %>
  </div>
</div>

<!-- Activity Tabs Section -->
<div class="center pad-inline" style="padding-block-end: var(--space-6);">
  <div class="container">
    <%= render Elements::PanelComponent.new do |c| %>
      <% c.with_body do %>
        <%= render Elements::TabsComponent.new(
          items: [
            {
              value: "ideas",
              label: "#{t('.tabs_ideas')} (#{@stats[:ideas_count]})",
              content: render("users/ideas_tab", ideas: @ideas)
            },
            {
              value: "comments",
              label: "#{t('.tabs_comments')} (#{@stats[:comments_count]})",
              content: render("users/comments_tab", comments: @comments)
            },
            {
              value: "likes",
              label: "#{t('.tabs_votes')} (#{@votes.size})",
              content: render("users/votes_tab", votes: @votes)
            }
          ],
          index_value: 0
        ) %>
      <% end %>
    <% end %>
  </div>
</div>
