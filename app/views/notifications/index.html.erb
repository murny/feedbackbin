<%# locals: () %>

<div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
  <div class="mx-auto max-w-3xl">
    <div class="mb-6 flex items-center justify-between">
      <h1 class="text-3xl font-bold text-foreground"><%= t(".title") %></h1>
      <% if Current.user.unread_notifications_count > 0 %>
        <%= button_to t(".mark_all_as_read"),
                      mark_all_as_read_notifications_path,
                      method: :post,
                      class: "btn btn-secondary text-sm" %>
      <% end %>
    </div>

    <% if @notifications.any? %>
      <div class="space-y-2">
        <% @notifications.each do |notification| %>
          <div class="<%= notification.read_at? ? "bg-background" : "bg-accent" %> rounded-lg border border-border p-4 hover:border-primary/50 transition-colors">
            <div class="flex items-start justify-between">
              <div class="flex-1 min-w-0">
                <%= link_to notification.event.url || "#", class: "block" do %>
                  <div class="flex items-center gap-2 mb-1">
                    <%= lucide_icon notification_icon(notification), class: "h-4 w-4 text-muted-foreground flex-shrink-0" %>
                    <p class="text-sm font-medium text-foreground">
                      <%= notification.event.message %>
                    </p>
                  </div>
                  <p class="text-xs text-muted-foreground">
                    <%= time_ago_in_words(notification.created_at) %> <%= t(".ago") %>
                  </p>
                <% end %>
              </div>
              <div class="ml-4 flex-shrink-0 flex items-center gap-2">
                <% unless notification.read_at? %>
                  <%= button_to notification_path(notification),
                                method: :patch,
                                params: { notification: { read_at: Time.current } },
                                class: "btn btn-ghost btn-sm",
                                title: t(".mark_as_read") do %>
                    <%= lucide_icon "check", class: "h-4 w-4" %>
                  <% end %>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <div class="mt-6">
        <%== pagy_nav(@notifications) %>
      </div>
    <% else %>
      <div class="text-center py-12">
        <%= lucide_icon "bell-off", class: "mx-auto h-12 w-12 text-muted-foreground" %>
        <h3 class="mt-2 text-sm font-semibold text-foreground"><%= t(".no_notifications") %></h3>
        <p class="mt-1 text-sm text-muted-foreground"><%= t(".no_notifications_description") %></p>
      </div>
    <% end %>
  </div>
</div>
