<% content_for :title, t(".title") %>

<div class="container container--wide pad-inline" style="padding-block: var(--space-8);">
  <!-- Page Header -->
  <div style="margin-block-end: var(--space-8);">
    <h1 class="txt-xx-large font-weight-bold" style="letter-spacing: -0.025em;"><%= t(".title") %></h1>
    <p class="txt-subtle" style="margin-block-start: var(--space-2);"><%= t(".description") %></p>
  </div>

  <%= turbo_frame_tag "roadmap_content", data: {
    turbo_action: "advance",
    action: "turbo:frame-load->search#searchComplete"
  } do %>
    <!-- Filters -->
    <div style="margin-block-end: var(--space-6);">
      <div class="flex flex-column" style="gap: var(--space-4); margin-block-end: var(--space-6);">
        <%= render "shared/board_filter",
          path_helper: :roadmap_path,
          boards: @boards,
          selected_board: @selected_board,
          turbo_frame: "roadmap_content",
          preserve_params: {
            sort: params[:sort],
            direction: params[:direction],
            search: @search
          } %>

        <%= render "shared/search_filter",
          path_helper: :roadmap_path,
          search_value: @search,
          turbo_frame: "roadmap_content",
          placeholder: t(".search_placeholder"),
          preserve_params: {
            board_id: params[:board_id],
            sort: params[:sort],
            direction: params[:direction]
          } %>
      </div>
    </div>

    <!-- Sort Options -->
    <div class="flex align-center txt-small" style="gap: var(--space-2); margin-block-end: var(--space-6);">
      <span class="txt-subtle font-weight-medium"><%= t(".sort_by_label") %></span>
      <div class="flex align-center border border-radius" style="gap: var(--space-1); padding: var(--space-1); background-color: var(--color-background);">
        <%= ideas_sort_link text: t(".sort_latest"), sort_field: "created_at", direction: "desc", params: params, path_helper: :roadmap_path, turbo_frame: "roadmap_content" %>
        <%= ideas_sort_link text: t(".sort_top"), sort_field: "votes_count", direction: "desc", params: params, path_helper: :roadmap_path, turbo_frame: "roadmap_content" %>
        <%= ideas_sort_link text: t(".sort_most_commented"), sort_field: "comments_count", direction: "desc", params: params, path_helper: :roadmap_path, turbo_frame: "roadmap_content" %>
      </div>
    </div>

    <!-- Empty State (if filters return no results) -->
    <% if @roadmap_data.values.all?(&:empty?) %>
      <div class="txt-align-center" style="padding-block: var(--space-12);">
        <%= lucide_icon "search-x", class: "center", style: "inline-size: 3rem; block-size: 3rem; margin-block-end: var(--space-4); color: var(--color-muted-foreground); opacity: 0.5;" %>
        <h3 class="txt-medium font-weight-bold" style="margin-block-end: var(--space-2);"><%= t(".no_results_title") %></h3>
        <p class="txt-subtle" style="margin-block-end: var(--space-4);"><%= t(".no_results_description") %></p>
        <%= link_to t(".clear_filters"), roadmap_path, class: "btn btn--primary", data: { turbo_frame: "roadmap_content" } %>
      </div>
    <% else %>
      <!-- Kanban Board -->
      <div class="<%= roadmap_grid_classes(@column_count) %>">
        <% @roadmap_data.each do |status, ideas| %>
          <%= render "column", status: status, ideas: ideas %>
        <% end %>
      </div>
    <% end %>
  <% end %>
</div>
