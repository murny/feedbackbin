<% content_for(:title) { t(".check_your_email") } %>

<div class="center full-width flex flex-column" style="max-inline-size: 24rem; gap: var(--space-6);">
  <%= render "shared/auth_branding" %>

  <div class="card flex flex-column <%= "animate-shake" if flash[:shake] %>" style="gap: var(--space-6); padding-block: var(--space-6);">
    <header class="txt-align-center" style="padding-inline: var(--space-6);">
      <h1 class="font-weight-semibold txt-x-large"><%= t(".check_your_email") %></h1>
      <p class="txt-subtle txt-small margin-block-start-half"><%= t(".enter_code_instructions") %></p>
    </header>

    <div class="grid" style="padding-inline: var(--space-6); gap: var(--space-6);">
      <%= form_with url: session_magic_link_path, method: :post, class: "grid", style: "gap: var(--space-6);", data: { controller: "magic-link" } do |form| %>
        <div class="grid" style="gap: var(--space-3);">
          <%= form.label :code, t(".verification_code"), class: "txt-small font-weight-medium" %>
          <%= form.text_field :code,
                required: true,
                autofocus: true,
                autocomplete: "one-time-code",
                autocorrect: "off",
                autocapitalize: "characters",
                spellcheck: "false",
                maxlength: "6",
                placeholder: t(".code_placeholder"),
                class: "txt-align-center txt-large txt-uppercase",
                style: "letter-spacing: 0.1em;",
                data: { "1p_ignore": true, magic_link_target: "input", action: "keydown.enter->magic-link#submitOnEnter paste->magic-link#submitOnPaste" } %>
        </div>

        <%= form.submit t(".verify_code"), class: "btn full-width" %>
      <% end %>

      <p class="txt-subtle txt-align-center txt-small">
        <%= t(".code_sent_to_html", email: content_tag(:strong, email_address_pending_authentication)) %>
        <br>
        <%= t(".code_expires_in", time: distance_of_time_in_words(MagicLink::EXPIRATION_TIME)) %>
      </p>
    </div>
  </div>

  <% if Rails.env.development? && flash[:magic_link_code].present? %>
    <div class="card pad fill-shade">
      <p class="txt-small txt-subtle txt-align-center">
        <span class="txt-x-small txt-uppercase font-weight-bold">Dev</span>
        <%= t(".your_code") %>:
        <code class="txt-large font-weight-bold" style="letter-spacing: 0.1em;"><%= flash[:magic_link_code] %></code>
      </p>
    </div>
  <% end %>
</div>
