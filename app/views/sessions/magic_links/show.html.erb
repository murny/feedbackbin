<% content_for(:title) { t(".check_your_email") } %>

<div class="container container--centered container--stack">
  <%= render "shared/auth_branding" %>

  <div class="panel <%= "animate-shake" if flash[:shake] %>">
    <header class="panel__header--centered">
      <h1 class="font-weight-bold txt-x-large"><%= t(".check_your_email") %></h1>
      <p class="txt-subtle txt-small margin-block-start-half"><%= t(".enter_code_instructions") %></p>
    </header>

    <div class="panel__content panel__content--stack">
      <%= form_with url: session_magic_link_path, method: :post, data: { controller: "magic-link" } do |form| %>
        <div class="grid gap-3">
          <%= form.label :code, t(".verification_code"), class: "txt-small font-weight-medium" %>
          <%= form.text_field :code,
                required: true,
                autofocus: true,
                autocomplete: "one-time-code",
                autocorrect: "off",
                autocapitalize: "characters",
                spellcheck: "false",
                maxlength: "6",
                placeholder: t(".code_placeholder"),
                class: "txt-align-center txt-large txt-uppercase",
                style: "--input-height: 2.75rem; letter-spacing: 0.2em;",
                data: { "1p_ignore": true, magic_link_target: "input", action: "keydown.enter->magic-link#submitOnEnter paste->magic-link#submitOnPaste" } %>
        </div>

        <div class="margin-block-start">
          <%= form.submit t(".verify_code"), class: "btn full-width" %>
        </div>
      <% end %>

      <p class="txt-subtle txt-align-center txt-small">
        <%= t(".code_sent_to_html", email: content_tag(:strong, email_address_pending_authentication)) %>
        <br>
        <%= t(".code_expires_in", time: distance_of_time_in_words(MagicLink::EXPIRATION_TIME)) %>
      </p>
    </div>
  </div>

  <% if Rails.env.development? && flash[:magic_link_code].present? %>
    <div class="panel pad fill-shade">
      <p class="txt-small txt-subtle txt-align-center">
        <span class="txt-x-small txt-uppercase font-weight-bold">Dev</span>
        <%= t(".your_code") %>:
        <code class="txt-large font-weight-bold" style="letter-spacing: 0.1em;"><%= flash[:magic_link_code] %></code>
      </p>
    </div>
  <% end %>
</div>
